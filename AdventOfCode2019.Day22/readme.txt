This puzzle completely beat me. Solution of part 2 isn't mine, it's based on this article:
https://www.reddit.com/r/adventofcode/comments/ee0rqi/2019_day_22_solutions/fbnkaju/
